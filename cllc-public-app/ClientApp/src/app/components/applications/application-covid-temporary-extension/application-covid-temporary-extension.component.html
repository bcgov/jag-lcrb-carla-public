<div class="form-wrapper" style="position: relative">
    <div [ngBusy]="busy"></div>

    <div>
        <div [formGroup]="form" style=" position: relative">
            <!-- Title -->
            <h1 class="ngtest-page-title">Covid Temporary Extension Application</h1>
        </div>

        <div [formGroup]="form">
            <!-- Preamble -->
            <section class="d-flex">
            <div class="flex-grow-0" style="width: 50px; background-color: #E1E8F2;"></div>
            <div class="flex-grow-1 p-3" style="background-color: #F1F4FA; padding: 20px;">
            <section class="ngtest-preamble-content">
                <p>To support B.C.’s licensed establishments in safely reopening for business while respecting the physical distancing 
                    guidelines outlined by the Provincial Health Officer (PHO) orders, this new authorization permits food primary, 
                    liquor primary and manufacturer licensees (i.e., wineries, breweries, distilleries) to temporarily expand their 
                    service areas until <strong>October 31, 2020</strong>.</p>
 
                <p>This authorization is subject to any restrictions within the Liquor Control and Licensing Act, Regulations, branch 
                    policies and/or original terms and conditions of licensing. It is important to note that this authorization will 
                    permit expanded service areas only and will not expand overall occupancy.</p>
 
                <p>To prevent further financial strain for those licensees most impacted by the pandemic, there will be <strong>no fees</strong> associated 
                    with the temporary extension application.</p>
 
                <p>Local governments will have two options for approval of temporary expansion authorizations for liquor primary and 
                    manufacturer licences:</p>
                    <ul style="font-size: larger;">
                        <li>pre-approval to cover all establishments within their jurisdiction who may apply for an expanded liquor service area; or</li>
                        <li>review of all individual requests prior to licensees submitting their applications to LCRB.</li>
                    </ul>

                    <p>If a local government chooses to review all individual requests for liquor primary and manufacturer applications, the LCRB will require those licensees to provide written approval from their local government with their application. Please get in touch with your local government to determine their approach prior to submitting your application.
                    Local government approval is not required for food primary licensees.</p>
                     
                    <p>If you currently have a complex permanent structural change application under review by the LCRB, you can submit a new application for a temporary expansion authorization to allow for the adherence of social distancing requirements within your current occupancy limits.</p>
                     
                    <p>To submit an application, please fill out the information in the form below.</p>
            </section>
            </div>
            </section>


            <h3 class="blue-header">LICENCE INFORMATION</h3>
            <section class="padded-section content-bottom">

                <app-field label="Licence Number" [valid]="isValidOrNotTouched('description1')"
                    errorMessage="Licence Number is a required field">
                    <input class="form-control" type="text" maxlength="7"
                        formControlName="description1" mask="000000">
                </app-field>

                <app-field label="Licence Type" [valid]="isValidOrNotTouched('licenceType')" [showChevrons]="false"
                    errorMessage="Licence Type is a required field" [isFullWidth]="true">
                    <mat-radio-group formControlName="licenceType">
                        <mat-radio-button class="mr-5" value="Food Primary">Food Primary</mat-radio-button>
                        <mat-radio-button class="mr-5" value="Liquor Primary">Liquor Primary</mat-radio-button>
                        <mat-radio-button class="mr-5" value="Liquor Primary Club">Liquor Primary Club</mat-radio-button>
                        <mat-radio-button value="Winery">Winery</mat-radio-button>
                    </mat-radio-group>
                </app-field>
                <hr>

                <app-field label="Establishment Name (as shown on licence)"
                    [valid]="isValidOrNotTouched('establishmentName')"
                    errorMessage="Establishment Name is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="establishmentName">
                </app-field>


                <app-field [valid]="true">
                    <label class="pr-5 m-0">Establishment address</label>

                    <div class="row">
                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('establishmentAddressStreet')"
                            errorMessage="Establishment  Address Street is a required field">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="Street"
                                formControlName="establishmentAddressStreet">
                        </app-field>

                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('establishmentAddressCity')"
                            errorMessage="Establishment  Address City is a required field">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="City"
                                formControlName="establishmentAddressCity">
                        </app-field>

                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('establishmentAddressPostalCode')"
                            errorMessage="This is required. The postal code should be in one of the following formats: X1X1X1 (no spaces)">
                            <input class="form-control" type="text" mask="A0A0A0" placeholder="Postal Code"
                                formControlName="establishmentAddressPostalCode">
                        </app-field>
                    </div>
                </app-field>

                <hr>

                <app-field label="Licensee Name (as shown on licence)" [valid]="isValidOrNotTouched('nameOfApplicant')"
                errorMessage="Licensee Name is a required field">
                <input class="form-control" style="width: 500px;" type="text" formControlName="nameOfApplicant">
                </app-field>

                <app-field label="Contact First Name" [valid]="isValidOrNotTouched('contactPersonFirstName')"
                    errorMessage="Contact First Name is a required field">
                    <input class="form-control" style="width: 500px;" type="text"
                        formControlName="contactPersonFirstName">
                </app-field>

                <app-field label="Contact Last Name" [valid]="isValidOrNotTouched('contactPersonLastName')"
                    errorMessage="Contact Last Name is a required field">
                    <input class="form-control" style="width: 500px;" type="text"
                        formControlName="contactPersonLastName">
                </app-field>

                <app-field label="Title/Position" [valid]="isValidOrNotTouched('contactPersonRole')"
                    errorMessage="Title/Position is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="contactPersonRole">
                </app-field>

                <app-field label="Business Tel" [valid]="isValidOrNotTouched('contactPersonPhone')"
                    errorMessage="Business Tel is a required field">
                    <input class="form-control" mask="(000) 000-0000" type="text" formControlName="contactPersonPhone">
                </app-field>

                <app-field label="Business Email" [valid]="isValidOrNotTouched('contactPersonEmail')"
                    errorMessage="Business Email is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="contactPersonEmail">
                </app-field>

                <app-field [valid]="true">
                    <section style="display: flex; align-items: center;">
                        <label class="pr-5 m-0">Mailing address</label>
                        <input type="checkbox" formControlName="sameAddresses">
                        <div class="pl-2">
                            Same as above
                        </div>
                    </section>
                    <div class="row">
                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('addressStreet')"
                            errorMessage="Establishment Mailing Address Street is a required field">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="Street"
                                formControlName="addressStreet">
                        </app-field>

                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('addressCity')"
                            errorMessage="Establishment Mailing Address City is a required field">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="City"
                                formControlName="addressCity">
                        </app-field>

                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('addressPostalCode')"
                            errorMessage="This is required. The postal code should be in one of the following formats: X1X1X1 (no spaces)">
                            <input class="form-control" type="text" placeholder="Postal Code"
                                formControlName="addressPostalCode">
                        </app-field>
                    </div>
                </app-field>
            </section>

            <h3 class="blue-header ngtest-declarations">
                TEMPORARY EXTENSION OF LICENSED AREA
            </h3>
            <div class="padded-section content-bottom">
                <p>
                    Please provide the following information and documents:
                </p>

                

                <ul>
                  <li>Current total capacity, including patios (as shown on licence);</li>
                  <li>Identify the area(s) to be extended;</li>
                  <li>
                    Floor plan of the extended area(s) showing how perimeter is defined, dimensions and its
                    physical relationship to existing licensed areas:
                  </li>
                  <li><ul>
                      <li>
                        Floor plan must have occupant load of the extended area marked/stamped on the plans
                        by provincial fire or building authority (or designate)
                        where the extension is indoors or within a permanent structure.
                      </li>
                      <li>
                        Provide proposed person capacity of extended area(s) if extension is outside; and
                      </li></ul>
                  </li>
                  <li>
                    Where the proposed area is not on property owned or controlled by the licensee, provide
                    written approval for such use from the property owner.
                  </li>

                </ul>               


                <section style="text-align: center; color: lightblue">
                  <app-delayed-file-uploader documentType="Floorplan" #floorplanDocuments id="floorplanDocuments"
                                     [enableFileDeletion]="true"
                                     [useDocumentTypeForName]="true" fileTypes="FILE MUST BE IN PDF, JPG OR PNG FORMAT." [multipleFiles]="true"
                                     entityName="application" [extensions]="['jpg', 'jpeg', 'png', 'pdf']"
                                     (numberOfUploadedFiles)="uploadedFloorplanDocuments = $event" 
                                     [uploadHeader]="'TO UPLOAD FLOOR PLAN, DRAG FILES HERE OR'">
                  </app-delayed-file-uploader>
                </section>
            </div>

            <h3 class="blue-header ngtest-declarations">
                ADD, CHANGE OR REMOVE A LICENSEE REPRESENTATIVE NOTIFICATION FORM (OPTIONAL)
            </h3>
            <div class="padded-section content-bottom">
                <p>
                    In some cases, a licensee may wish to authorize a specific individual to take certain actions on the
                    licensee's behalf and to legally bind the licensee in respect of those matters. For example:
                </p>
                <ul>
                    <li>
                        A licensee that is a company may wish to authorize an employee who is not a company director or
                        officer.
                    </li>
                    <li>
                        A partner in a partnership may wish to authorize a manager at the establishment who is not a
                        partner.
                    </li>
                    <li>
                        A society may wish to authorize an individual who is not a director or senior manager of the
                        society.
                    </li>
                    <li>
                        A licensee who is an individual person may wish to authorize someone else to make decisions and
                        take actions in respect of specific liquor control and licensing matters.
                    </li>
                </ul>
                <p>
                    Download the form <a href="">here</a>.
                </p>

                <section style="text-align: center; color: lightblue">
                  <app-delayed-file-uploader documentType="LicenseeRepresentativeNotficationForm" #licenseeRepresentativeNotficationFormDocuments id="licenseeRepresentativeNotficationFormDocuments"
                                             [enableFileDeletion]="true"
                                             [useDocumentTypeForName]="true" fileTypes="FILE MUST BE IN PDF, JPG OR PNG FORMAT." [multipleFiles]="true"
                                             entityName="application" [extensions]="['jpg', 'jpeg', 'png', 'pdf']"
                                             (numberOfUploadedFiles)="uploadedLicenseeRepresentativeNotficationFormDocuments = $event" 
                                             [uploadHeader]="'TO UPLOAD LICENSEE REPRESENTATIVE NOTIFICATION FORM, DRAG FILES HERE OR'">
                  </app-delayed-file-uploader>
                </section>
            </div>

            <h3 class="blue-header ngtest-declarations">
                LOCAL GOVERNMENT/FIRST NATION COMMENTS
            </h3>
            <div class="padded-section content-bottom">
                <p>
                    This application process requires comment from your local government/First Nation. Please download
                    and take the completed application form and all required documents to their local government/First
                    Nation and request that the local government/First Nation complete.
                </p>
                <app-field [valid]="!showValidationMessages || form.get('receivedLGPermission').valid"
                    errorMessage="Please affirm that all of the information provided for this application is true and complete."
                    [showChevrons]="false">
                    <section style="display: flex">
                        <input type="checkbox" formControlName="receivedLGPermission">
                        <span class="error-states">*</span>
                        <div style="padding-left: 10px;">
                            I have received permission from my Local Government.
                        </div>
                    </section>
                </app-field>
            </div>

            <h3 class="blue-header ngtest-declarations" style="margin-bottom: 0px;">
                DECLARATIONS
            </h3>

                <section class="d-flex content-bottom" style="margin-top: 0px; padding:0px;">
                    <div class="flex-grow-0" style="width: 50px; background-color: #E1E8F2;"></div>
                    <div class="flex-grow-1 p-3" style="background-color: #F1F4FA; padding: 20px;">
                    <section class="ngtest-preamble-content">
                            <p><strong>Section 57(1)(c)</strong> of the <strong>Liquor Control and Licensing Act</strong> states: <i>“A person commits an offence if the person (c) 
                                provides false or misleading information in the following circumstances: (i) when making an application referred to in section 12; (ii) when 
                                making a report or when required and as specified by the general manager under section 59.</i>
                            </p>
                        <app-field [valid]="!showValidationMessages || form.get('signatureAgreement').valid"
                            errorMessage="Please affirm that all of the information provided for this application is true and complete."
                            [showChevrons]="false">
                            <section style="display: flex">
                                <input type="checkbox" formControlName="signatureAgreement">
                                <span class="error-states">*</span>
                                <div style="padding-left: 10px; font-size: larger;">
                                    As the licensee or authorized signatory of the licensee, I understand and affirm that all of
                                    the information provided is true and complete.
                                </div>
                            </section>
                        </app-field>
                    </section>
                    </div>
                </section>
            

            <section class="error mt-3 p-3" *ngIf="!form.valid && form.touched">
                <div *ngIf="!validationMessages?.length">
                    <i class="fas fa-exclamation-triangle" style="margin-right: 5px;"></i>
                    <span>Some required fields have not been completed</span>
                </div>
                <div *ngIf="validationMessages?.length">
                    <i class="fas fa-exclamation-triangle" style="margin-right: 5px;"></i>
                    <span>The following fields are not valid:</span>
                </div>
                <ul *ngFor="let message of validationMessages">
                    <li class="app-cancel">
                        {{message}}
                    </li>
                </ul>
            </section>

            <section style="position: relative; margin-top: 20px;">
                <button class="btn btn-primary" (click)="submitApplication()">
                    <i class="fa fa-save" style="color: #fff;"></i>
                    SUBMIT APPLICATION</button>
                <span style="float: right; color: #1a5a96; padding-top: 10px;">
                    <a routerLink="/">
                        <i class="fas fa-trash-alt" style="color: #1a5a96;"></i>
                        Cancel Application
                    </a>
                </span>
                <div [ngBusy]="busy"></div>
            </section>
        </div>
    </div>
</div>
